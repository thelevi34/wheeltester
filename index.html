<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wheel Tester</title>
    <!-- EmailJS Library -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        // Initialize EmailJS with your Public Key
        (function(){
            emailjs.init('4vxGc_DEfLttFT6fG');
        })();
    </script>
    <style>
        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #1a1f3a;
            --bg-tertiary: #252a45;
            --accent-primary: #00d9ff;
            --accent-secondary: #0099ff;
            --accent-success: #00ff88;
            --accent-danger: #ff4444;
            --accent-warning: #ffa500;
            --text-primary: #ffffff;
            --text-secondary: #8b92b8;
            --text-muted: #5a5f7d;
            --border-color: #2a2f4a;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
            --button-bg: #1e2338;
            --button-border: #2d3350;
        }

        body.light-mode {
            --bg-primary: #f0f2f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8eaf0;
            --accent-primary: #0099ff;
            --accent-secondary: #0066cc;
            --accent-success: #00cc66;
            --accent-danger: #ff4444;
            --accent-warning: #ff9900;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4f6a;
            --text-muted: #7a7f9a;
            --border-color: #d0d5e0;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --button-bg: #f8f9fc;
            --button-border: #d0d5e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 0;
            line-height: 1.6;
        }

        /* Navigation Bar */
        .nav-bar {
            background: var(--bg-secondary);
            padding: 0;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5), 0 0 40px rgba(0, 217, 255, 0.1);
            border-bottom: 1px solid rgba(0, 217, 255, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            height: 70px;
            position: relative;
        }

        .nav-header {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            position: relative;
            padding: 8px 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-logo::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 0;
            background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
            transition: height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 2px;
        }

        .nav-logo:hover::before {
            height: 100%;
        }

        .nav-logo:hover {
            transform: translateX(5px);
        }

        .nav-logo-text {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            white-space: nowrap;
            letter-spacing: 4px;
            text-transform: uppercase;
            position: relative;
            text-shadow: 0 0 20px rgba(0, 217, 255, 0.3);
        }

        .nav-logo-text .highlight {
            color: var(--accent-primary);
            font-weight: 300;
            letter-spacing: 2px;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-tertiary);
            padding: 6px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        .nav-link {
            padding: 10px 24px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 217, 255, 0.1), rgba(0, 153, 255, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary);
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-link:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .nav-link:hover::before {
            opacity: 1;
        }

        .nav-link:hover::after {
            width: 80%;
        }

        .nav-link.active {
            color: var(--accent-primary);
            background: rgba(0, 217, 255, 0.1);
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.2), inset 0 0 20px rgba(0, 217, 255, 0.1);
        }

        .nav-link.active::after {
            width: 80%;
        }

        /* Theme Toggle - Premium Design */
        .theme-toggle {
            position: absolute;
            top: 50%;
            right: 40px;
            transform: translateY(-50%);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            padding: 8px 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .theme-toggle:hover::before {
            left: 100%;
        }

        .theme-toggle:hover {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.4), 0 4px 20px rgba(0, 0, 0, 0.4);
            transform: translateY(-50%) scale(1.05);
        }

        .theme-toggle:active {
            transform: translateY(-50%) scale(0.98);
        }

        .theme-icon {
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover .theme-icon {
            transform: rotate(20deg) scale(1.1);
        }

        /* Report Problem Modal */
        .report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .report-modal.active {
            display: flex;
        }

        .report-content {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.9);
            position: relative;
        }

        .report-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .report-close:hover {
            color: var(--accent-danger);
            transform: scale(1.2);
        }

        .report-title {
            font-size: 1.5rem;
            color: var(--accent-primary);
            margin-bottom: 20px;
        }

        .report-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .report-form label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .report-form select,
        .report-form input,
        .report-form textarea {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: all 0.3s ease;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .report-form select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d9ff' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 35px;
        }

        .report-form select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 10px;
        }

        .report-form select:focus,
        .report-form input:focus,
        .report-form textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 10px rgba(0, 217, 255, 0.3);
        }

        .report-form textarea {
            min-height: 100px;
            resize: vertical;
        }

        .report-submit {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 217, 255, 0.3);
            position: relative;
        }

        .report-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 217, 255, 0.5);
        }

        .report-submit:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .submit-loader {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .submit-loader svg {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .report-btn {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: var(--accent-warning);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 165, 0, 0.4);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .report-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(255, 165, 0, 0.6);
        }

        .report-btn svg {
            width: 28px;
            height: 28px;
            stroke: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 20px;
            background: var(--bg-secondary);
            border-radius: 15px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--button-bg);
            border: 2px solid var(--button-border);
            border-radius: 25px;
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
            transform: scale(1.05);
        }

        .theme-icon {
            font-size: 1.2rem;
        }

        /* Rating System */
        .rating-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            min-width: 250px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .rating-container.hidden {
            display: none;
        }

        .rating-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
            transition: all 0.2s ease;
        }

        .rating-close:hover {
            color: var(--accent-danger);
            transform: scale(1.2);
        }

        /* Start Rating Button */
        .start-rating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 25px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
            z-index: 999;
        }

        .start-rating-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.5);
        }

        .start-rating-btn:active {
            transform: translateY(0);
        }

        .start-rating-btn.hidden {
            display: none;
        }

        .rating-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 15px;
            text-align: center;
        }

        .rating-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .rating-item:last-child {
            border-bottom: none;
        }

        .rating-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rating-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .rating-status {
            font-weight: bold;
            font-size: 0.9rem;
            min-width: 40px;
            text-align: center;
        }

        .rating-percent {
            font-size: 0.85rem;
            color: var(--accent-primary);
            font-weight: 600;
            min-width: 35px;
            text-align: right;
        }

        .rating-status.completed {
            color: var(--accent-success);
        }

        .rating-status.incomplete {
            color: var(--text-muted);
        }

        .rating-total {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--accent-primary);
            text-align: center;
        }

        .rating-percentage {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-primary);
        }

        .rating-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .rating-grade {
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 10px;
            padding: 8px 15px;
            border-radius: 8px;
            background: var(--bg-tertiary);
        }

        .rating-grade.excellent {
            color: #00ff00;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        .rating-grade.good {
            color: #00d9ff;
            text-shadow: 0 0 10px rgba(0, 217, 255, 0.5);
        }

        .rating-grade.average {
            color: #ffa500;
            text-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
        }

        .rating-grade.poor {
            color: #ff4444;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* Status Bar */
        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 0;
            background: transparent;
            border-radius: 0;
            margin-bottom: 30px;
            box-shadow: none;
            border: none;
        }

        .status-item {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .status-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.7);
            border-color: var(--accent-primary);
        }

        .status-item .label {
            color: var(--text-muted);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .status-item .value {
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.2rem;
        }

        #connection-status {
            padding: 8px 16px;
            border-radius: 25px;
            background: var(--accent-danger);
            color: white;
            font-size: 0.9rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.4);
        }

        #connection-status::before {
            content: '●';
            font-size: 1.2rem;
            animation: pulse 2s ease-in-out infinite;
        }

        #connection-status.connected {
            background: var(--accent-success);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        /* Warning */
        .warning {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 40px 50px;
            background: rgba(255, 165, 0, 0.15);
            border: 3px solid var(--accent-warning);
            border-radius: 15px;
            margin: 0 auto 30px auto;
            max-width: 900px;
            color: var(--accent-warning);
            box-shadow: 0 8px 30px rgba(255, 165, 0, 0.3);
        }

        .warning.hidden {
            display: none;
        }

        .warning svg {
            flex-shrink: 0;
            width: 48px;
            height: 48px;
        }

        .warning div {
            flex: 1;
            text-align: center;
        }

        .warning strong {
            display: block;
            margin-bottom: 10px;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .warning p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        /* Main Content */
        .main-content {
            display: none;
        }

        .main-content.visible {
            display: block;
        }

        /* Sections */
        .section {
            background: var(--bg-secondary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .section h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-primary);
        }

        /* Steering Section */
        .steering-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        .wheel-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-primary);
            text-align: center;
            padding: 10px 20px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            border: 2px solid var(--border-color);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }

        .steering-wheel {
            position: relative;
            width: 250px;
            height: 250px;
            transition: transform 0.05s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .steering-wheel img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .wheel-indicator {
            position: absolute;
            top: 0px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 20px;
            background: var(--accent-success);
            border-radius: 4px;
            box-shadow: 0 0 10px var(--accent-success);
            z-index: 10;
        }

        .steering-info {
            text-align: center;
        }

        .steering-value {
            font-size: 3rem;
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 10px;
        }

        .steering-direction {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* Pedals Section */
        .pedals-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 30px;
        }

        .pedal {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .pedal-label {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .pedal-image-container {
            position: relative;
            width: 180px;
            height: 350px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .pedal-image {
            width: 180px;
            height: auto;
            max-height: 350px;
            object-fit: contain;
            transition: all 0.1s ease-out;
            filter: brightness(0.5);
        }

        .pedal-image.pressed {
            filter: brightness(1) drop-shadow(0 0 15px currentColor);
            transform: translateY(5px);
        }

        #pedal-image-accelerator.pressed {
            color: #00ff00;
        }

        #pedal-image-brake.pressed {
            color: #ff0000;
        }

        #pedal-image-clutch.pressed {
            color: #0099ff;
        }

        .pedal-bar {
            position: relative;
            width: 60px;
            height: 250px;
            background: var(--bg-tertiary);
            border-radius: 30px;
            border: 2px solid var(--border-color);
            overflow: hidden;
            display: none;
        }

        .pedal-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0%;
            border-radius: 30px;
            transition: height 0.05s ease-out;
        }

        #pedal-accelerator {
            background: linear-gradient(to top, #00ff00, #00cc00);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        #pedal-brake {
            background: linear-gradient(to top, #ff0000, #cc0000);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        }

        #pedal-clutch {
            background: linear-gradient(to top, #0099ff, #0066cc);
            box-shadow: 0 0 20px rgba(0, 153, 255, 0.5);
        }

        .pedal-value {
            font-size: 1.3rem;
            font-weight: bold;
        }

        #value-accelerator {
            color: #00ff00;
        }

        #value-brake {
            color: #ff0000;
        }

        #value-clutch {
            color: #0099ff;
        }

        /* Controller Buttons Section */
        .controller-layout {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            max-width: 900px;
            margin: 0 auto;
        }

        .controller-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .controller-group h3 {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 5px;
        }

        /* D-Pad */
        .dpad-container {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 0px;
            justify-content: center;
        }

        .dpad-btn {
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s ease;
        }

        .dpad-btn img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            transition: all 0.1s ease;
        }

        .dpad-btn.pressed {
            transform: scale(0.95);
        }

        .dpad-btn.pressed img {
            filter: drop-shadow(0 0 12px rgba(0, 217, 255, 0.9));
        }

        .dpad-up { grid-column: 2; grid-row: 1; }
        .dpad-left { grid-column: 1; grid-row: 2; }
        .dpad-right { grid-column: 3; grid-row: 2; }
        .dpad-down { grid-column: 2; grid-row: 3; }

        /* Face Buttons (A, B, X, Y) */
        .face-buttons {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
            justify-content: center;
        }

        .face-btn {
            background: var(--button-bg);
            border: 2px solid var(--button-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--text-primary);
            transition: all 0.1s ease;
            position: relative;
            overflow: hidden;
        }

        .face-btn img {
            width: 55px;
            height: 55px;
            object-fit: contain;
            transition: all 0.1s ease;
        }

        .face-btn.pressed {
            transform: scale(0.95);
        }

        .btn-y { grid-column: 2; grid-row: 1; }
        .btn-x { grid-column: 1; grid-row: 2; }
        .btn-b { grid-column: 3; grid-row: 2; }
        .btn-a { grid-column: 2; grid-row: 3; }

        .btn-y.pressed { box-shadow: 0 0 20px #00ff00; }
        .btn-y.pressed img { filter: drop-shadow(0 0 10px #00ff00); }

        .btn-x.pressed { box-shadow: 0 0 20px #ff1493; }
        .btn-x.pressed img { filter: drop-shadow(0 0 10px #ff1493); }

        .btn-b.pressed { box-shadow: 0 0 20px #ff0000; }
        .btn-b.pressed img { filter: drop-shadow(0 0 10px #ff0000); }

        .btn-a.pressed { box-shadow: 0 0 20px #0099ff; }
        .btn-a.pressed img { filter: drop-shadow(0 0 10px #0099ff); }

        /* Shoulder Buttons */
        .shoulder-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .shoulder-btn {
            padding: 15px 20px;
            background: var(--button-bg);
            border: 2px solid var(--button-border);
            border-radius: 10px;
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-primary);
            transition: all 0.1s ease;
        }

        .shoulder-btn.pressed {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
            transform: scale(0.95);
            box-shadow: 0 0 15px rgba(0, 217, 255, 0.6);
        }

        /* Center Buttons */
        .center-buttons {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
        }

        .center-btn {
            width: 60px;
            height: 60px;
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s ease;
        }

        .center-btn img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            transition: all 0.1s ease;
        }

        .center-btn.ps-btn img {
            width: 65px;
            height: 65px;
        }

        .center-btn.ps-btn {
            width: 50px;
            height: 50px;
            background: var(--button-bg);
            border: 2px solid var(--button-border);
            border-radius: 50%;
            font-size: 0.95rem;
            font-weight: bold;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .center-btn.ps-btn.pressed {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
            transform: scale(0.95);
            box-shadow: 0 0 15px rgba(0, 217, 255, 0.6);
        }

        .center-btn.pressed {
            transform: scale(0.95);
        }

        .center-btn.pressed img {
            filter: drop-shadow(0 0 12px rgba(0, 217, 255, 0.9));
        }

        /* Extra Buttons */
        .extra-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .extra-btn {
            padding: 12px;
            background: var(--button-bg);
            border: 2px solid var(--button-border);
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.1s ease;
        }

        .extra-btn.pressed {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
            transform: scale(0.95);
            box-shadow: 0 0 15px rgba(0, 217, 255, 0.6);
        }

        /* Shifter Section */
        .shifter-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .shifter-visual {
            position: relative;
            width: 400px;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .shifter-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .shifter-indicator {
            position: absolute;
            width: 100px;
            height: 100px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            transition: all 0.2s ease;
            pointer-events: none;
            display: none;
        }

        .shifter-indicator.active {
            display: block;
        }

        .shifter-pattern {
            display: none;
        }

        .shifter-gear {
            display: none;
        }

        .shifter-info {
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .shifter-current {
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .shifter-current span {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-primary);
            margin-left: 10px;
        }

        /* Controls Section */
        .controls-section {
            text-align: center;
        }

        .btn-calibrate {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
        }

        .btn-calibrate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.5);
        }

        .btn-calibrate:active {
            transform: translateY(0);
        }

        .calibrate-info {
            margin-top: 15px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-secondary);
        }

        /* Animations */
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .nav-container {
                padding: 0 25px;
                height: 65px;
            }

            .nav-logo-text {
                font-size: 1.3rem;
                letter-spacing: 3px;
            }

            .nav-link {
                padding: 8px 18px;
                font-size: 0.85rem;
            }

            .theme-toggle {
                right: 25px;
                padding: 6px 14px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                height: auto;
                padding: 15px 20px;
                gap: 15px;
            }

            .nav-header {
                width: 100%;
                justify-content: center;
            }

            .nav-logo-text {
                font-size: 1.2rem;
                letter-spacing: 2px;
            }

            .nav-links {
                width: 100%;
                justify-content: center;
            }

            .nav-link {
                padding: 10px 20px;
                font-size: 0.85rem;
            }

            .theme-toggle {
                position: relative;
                right: auto;
                top: auto;
                transform: none;
                margin-top: 10px;
            }

            .theme-toggle:hover {
                transform: scale(1.05);
            }

            header h1 {
                font-size: 2rem;
            }

            .status-bar {
                flex-direction: column;
                gap: 10px;
            }

            .steering-wheel {
                width: 200px;
                height: 200px;
            }

            .steering-value {
                font-size: 2.5rem;
            }

            .pedals-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 15px;
            }

            .pedal-bar {
                height: 180px;
                width: 50px;
            }

            .controller-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .dpad-container,
            .face-buttons {
                grid-template-columns: repeat(3, 50px);
                grid-template-rows: repeat(3, 50px);
            }

            .extra-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .section {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            header {
                padding: 20px 15px;
            }

            header h1 {
                font-size: 1.5rem;
            }

            .subtitle {
                font-size: 0.9rem;
            }

            .pedals-container {
                gap: 10px;
            }

            .pedal-bar {
                height: 150px;
                width: 40px;
            }
        }

        /* Success Page */
        #success-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .success-content {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 50px 40px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 50px rgba(0, 217, 255, 0.3);
            border: 2px solid var(--accent-primary);
            animation: slideUp 0.4s ease;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-success), var(--accent-primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
            margin: 0 auto 30px;
            animation: scaleIn 0.5s ease;
        }

        .success-title {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .success-message {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .success-email {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            border-left: 4px solid var(--accent-primary);
        }

        .success-email strong {
            color: var(--accent-primary);
        }

        .success-details {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: left;
        }

        .success-details p {
            margin: 10px 0;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        .success-details strong {
            color: var(--accent-primary);
            margin-right: 10px;
        }

        .success-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            padding: 15px 60px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 217, 255, 0.4);
        }

        .success-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 217, 255, 0.6);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <div class="nav-container">
            <div class="nav-header">
                <a href="index.html" class="nav-logo">
                    <span class="nav-logo-text">WHEEL<span class="highlight">TESTER</span></span>
                </a>
                <div class="nav-links">
                    <a href="index.html" class="nav-link active">Wheel Tester</a>
                    <a href="wheel-library.html" class="nav-link">Wheel Library</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header>
            <button class="theme-toggle" id="theme-toggle">
                <span class="theme-icon" id="theme-icon">☀️</span>
                <span id="theme-text">Light Mode</span>
            </button>
            <h1>Wheel Tester</h1>
            <p class="subtitle">Racing Wheel Diagnostic Tool</p>
        </header>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <span class="label">Status:</span>
                <span class="value" id="connection-status">Disconnected</span>
            </div>
            <div class="status-item">
                <span class="label">Device:</span>
                <span class="value" id="gamepad-name">None</span>
            </div>
        </div>

        <!-- Warning Message -->
        <div class="warning" id="warning">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 2s linear infinite;">
                <polyline points="23 4 23 10 17 10"></polyline>
                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
            </svg>
            <div>
                <strong>Connect your wheel and press buttons to begin...</strong>
                <p class="warning-text">Plug in your racing wheel and press any button to begin.</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Steering Section -->
            <section class="section steering-section">
                <h2>Steering Wheel</h2>
                <div class="steering-container">
                    <div class="wheel-name" id="wheel-name">Racing Wheel</div>
                    <div class="steering-wheel" id="steering-wheel">
                        <img src="https://i.ibb.co/spBT4c0v/steering-wheel-clipart-design-illustration-free-png.webp" alt="Steering Wheel" />
                        <div class="wheel-indicator"></div>
                    </div>
                    <div class="steering-info">
                        <div class="steering-value">
                            <span id="steering-percent">0</span>°
                        </div>
                        <div class="steering-direction" id="steering-direction">CENTER</div>
                    </div>
                </div>
            </section>

            <!-- Pedals Section -->
            <section class="section pedals-section">
                <h2>Pedals</h2>
                <div class="pedals-container">
                    <div class="pedal">
                        <div class="pedal-label">Clutch</div>
                        <div class="pedal-image-container">
                            <img src="pd-clutch.png" alt="Clutch Pedal" class="pedal-image" id="pedal-image-clutch">
                        </div>
                        <div class="pedal-value" id="value-clutch">0%</div>
                    </div>
                    <div class="pedal">
                        <div class="pedal-label">Brake</div>
                        <div class="pedal-image-container">
                            <img src="pd-break.png" alt="Brake Pedal" class="pedal-image" id="pedal-image-brake">
                        </div>
                        <div class="pedal-value" id="value-brake">0%</div>
                    </div>
                    <div class="pedal">
                        <div class="pedal-label">Accelerator</div>
                        <div class="pedal-image-container">
                            <img src="pd-acce.png" alt="Accelerator Pedal" class="pedal-image" id="pedal-image-accelerator">
                        </div>
                        <div class="pedal-value" id="value-accelerator">0%</div>
                    </div>
                </div>
            </section>

            <!-- Controller Buttons Section -->
            <section class="section buttons-section">
                <h2>Buttons</h2>
                <div class="controller-layout">
                    <!-- Left Side: D-Pad & Shoulder -->
                    <div class="controller-group">
                        <div class="shoulder-buttons">
                            <div class="shoulder-btn" data-button="5">L1</div>
                            <div class="shoulder-btn" data-button="7">L2</div>
                        </div>
                        <h3>D-Pad</h3>
                        <div class="dpad-container">
                            <div class="dpad-btn dpad-up" data-button="12"><img src="up.png" alt="▲"></div>
                            <div class="dpad-btn dpad-left" data-button="14"><img src="left.png" alt="◄"></div>
                            <div class="dpad-btn dpad-right" data-button="15"><img src="right.png" alt="►"></div>
                            <div class="dpad-btn dpad-down" data-button="13"><img src="down.png" alt="▼"></div>
                        </div>
                    </div>

                    <!-- Center: Face Buttons & Center Buttons -->
                    <div class="controller-group">
                        <div class="shoulder-buttons">
                            <div class="shoulder-btn" data-button="4">R1</div>
                            <div class="shoulder-btn" data-button="6">R2</div>
                        </div>
                        <h3>Face Buttons</h3>
                        <div class="face-buttons">
                            <div class="face-btn btn-y" data-button="3"><img src="triangle.png" alt="△"></div>
                            <div class="face-btn btn-x" data-button="1"><img src="square.png" alt="□"></div>
                            <div class="face-btn btn-b" data-button="2"><img src="circle.png" alt="○"></div>
                            <div class="face-btn btn-a" data-button="0"><img src="x.png" alt="✕"></div>
                        </div>
                        <div class="center-buttons">
                            <div class="center-btn" data-button="8"><img src="select.png" alt="SHARE"></div>
                            <div class="center-btn ps-btn" data-button="24">PS</div>
                            <div class="center-btn" data-button="9"><img src="start.png" alt="OPTIONS"></div>
                        </div>
                    </div>

                    <!-- Right Side: Extra Buttons -->
                    <div class="controller-group">
                        <h3>Wheel Buttons</h3>
                        <div class="extra-buttons">
                            <div class="extra-btn" data-button="11">L3</div>
                            <div class="extra-btn" data-button="10">R3</div>
                            <div class="extra-btn" data-button="19">+</div>
                            <div class="extra-btn" data-button="20">-</div>
                            <div class="extra-btn" data-button="22">◄</div>
                            <div class="extra-btn" data-button="21">►</div>
                            <div class="extra-btn" data-button="23">⏎</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Shifter Section -->
            <section class="section shifter-section">
                <h2>Shifter</h2>
                <div class="shifter-container">
                    <div class="shifter-visual">
                        <img src="SHIFTER.png" alt="Shifter" class="shifter-image">
                        <div class="shifter-indicator" id="shifter-indicator"></div>
                    </div>
                    <div class="shifter-info">
                        <div class="shifter-current">Current Gear: <span id="current-gear">N</span></div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- Rating System -->
    <div class="rating-container hidden" id="rating-container">
        <button class="rating-close" id="rating-close">✕</button>
        <div class="rating-title">Wheel Test Rating</div>
        <div class="rating-item">
            <span class="rating-label">Steering (L/R)</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-steering">0/2</span>
                <span class="rating-percent" id="rating-steering-percent">0%</span>
            </div>
        </div>
        <div class="rating-item">
            <span class="rating-label">Accelerator</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-accelerator">✗</span>
                <span class="rating-percent" id="rating-accelerator-percent">0%</span>
            </div>
        </div>
        <div class="rating-item">
            <span class="rating-label">Brake</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-brake">✗</span>
                <span class="rating-percent" id="rating-brake-percent">0%</span>
            </div>
        </div>
        <div class="rating-item">
            <span class="rating-label">Clutch</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-clutch">✗</span>
                <span class="rating-percent" id="rating-clutch-percent">0%</span>
            </div>
        </div>
        <div class="rating-item">
            <span class="rating-label">All Buttons</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-buttons">0/22</span>
                <span class="rating-percent" id="rating-buttons-percent">0%</span>
            </div>
        </div>
        <div class="rating-item">
            <span class="rating-label">All Gears</span>
            <div class="rating-right">
                <span class="rating-status incomplete" id="rating-gears">0/7</span>
                <span class="rating-percent" id="rating-gears-percent">0%</span>
            </div>
        </div>
        <div class="rating-total">
            <div class="rating-percentage" id="rating-percentage">0%</div>
            <div class="rating-text">Overall Rating</div>
            <div class="rating-grade poor" id="rating-grade">Poor</div>
        </div>
    </div>

    <!-- Start Rating Button -->
    <button class="start-rating-btn" id="start-rating-btn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </svg>
        Start Rating
    </button>

    <!-- Report Problem Button -->
    <button class="report-btn" id="report-btn" title="Report Problem">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
    </button>

    <!-- Report Problem Modal -->
    <div class="report-modal" id="report-modal">
        <div class="report-content">
            <button class="report-close" id="report-close">✕</button>
            <h2 class="report-title">Report a Problem</h2>
            <form class="report-form" id="report-form">
                <div>
                    <label>Your Wheel:</label>
                    <select id="report-wheel" required>
                        <option value="" disabled selected>Select your wheel</option>
                        <option value="Logitech G29">Logitech G29</option>
                        <option value="Logitech G920">Logitech G920</option>
                        <option value="Logitech G923">Logitech G923</option>
                        <option value="Logitech G27">Logitech G27</option>
                        <option value="Logitech G25">Logitech G25</option>
                        <option value="Thrustmaster T300">Thrustmaster T300</option>
                        <option value="Thrustmaster T500">Thrustmaster T500</option>
                        <option value="Thrustmaster TX">Thrustmaster TX</option>
                        <option value="Fanatec CSL">Fanatec CSL</option>
                        <option value="Fanatec ClubSport">Fanatec ClubSport</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div id="other-wheel-container" style="display: none;">
                    <label>Specify Wheel:</label>
                    <input type="text" id="other-wheel-input" placeholder="Enter your wheel name...">
                </div>
                <div>
                    <label>Problem Type:</label>
                    <select id="report-problem" required>
                        <option value="" disabled selected>Select problem type</option>
                        <option value="Steering not working">Steering not working</option>
                        <option value="Pedals not responding">Pedals not responding</option>
                        <option value="Buttons not detected">Buttons not detected</option>
                        <option value="Shifter not working">Shifter not working</option>
                        <option value="Force feedback issue">Force feedback issue</option>
                        <option value="Calibration problem">Calibration problem</option>
                        <option value="Wheel not detected">Wheel not detected</option>
                        <option value="Website bug">Website bug</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div id="other-problem-container" style="display: none;">
                    <label>Specify Problem:</label>
                    <input type="text" id="other-problem-input" placeholder="Please specify the problem...">
                </div>
                <div>
                    <label>Your Email:</label>
                    <input type="email" id="report-email" placeholder="your@email.com" required>
                </div>
                <div>
                    <label>Description (optional):</label>
                    <textarea id="report-description" placeholder="Please describe the problem in detail..."></textarea>
                </div>
                <button type="submit" class="report-submit" id="report-submit-btn">
                    <span class="submit-text">Submit Report</span>
                    <span class="submit-loader" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                            <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
                            <path d="M12 2 A10 10 0 0 1 22 12" stroke-linecap="round"></path>
                        </svg>
                        Sending...
                    </span>
                </button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer style="background: var(--bg-secondary); margin-top: 50px; padding: 40px 20px; border-top: 2px solid var(--border-color);">
        <div style="max-width: 1400px; margin: 0 auto;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 30px;">
                <!-- About Section -->
                <div>
                    <h3 style="color: var(--accent-primary); margin-bottom: 15px; font-size: 1.2rem;">About Wheel Tester</h3>
                    <p style="color: var(--text-secondary); line-height: 1.8; font-size: 0.95rem;">
                        Professional racing wheel diagnostic tool for testing and calibrating all major racing wheels including Logitech, Thrustmaster, Fanatec and more. Test all inputs, buttons, pedals, and shifter functionality.
                    </p>
                </div>
                
                <!-- Supported Devices -->
                <div>
                    <h3 style="color: var(--accent-primary); margin-bottom: 15px; font-size: 1.2rem;">Supported Devices</h3>
                    <ul style="list-style: none; padding: 0; color: var(--text-secondary); line-height: 2;">
                        <li>✓ Logitech (G29, G920, G923, G27, G25)</li>
                        <li>✓ Thrustmaster (T300, T500, TX, etc.)</li>
                        <li>✓ Fanatec (CSL, ClubSport, etc.)</li>
                        <li>✓ And other compatible wheels</li>
                    </ul>
                </div>
                
                <!-- Features -->
                <div>
                    <h3 style="color: var(--accent-primary); margin-bottom: 15px; font-size: 1.2rem;">Features</h3>
                    <ul style="list-style: none; padding: 0; color: var(--text-secondary); line-height: 2;">
                        <li>✓ Real-time input testing</li>
                        <li>✓ 900° steering rotation</li>
                        <li>✓ 3-pedal support</li>
                        <li>✓ H-pattern shifter (7 gears)</li>
                        <li>✓ All buttons & D-pad</li>
                        <li>✓ Rating system</li>
                    </ul>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 style="color: var(--accent-primary); margin-bottom: 15px; font-size: 1.2rem;">Quick Links</h3>
                    <ul style="list-style: none; padding: 0; line-height: 2;">
                        <li><a href="g29-wheel-tester (6).html" style="color: var(--text-secondary); text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='var(--accent-primary)'" onmouseout="this.style.color='var(--text-secondary)'">Wheel Tester</a></li>
                        <li><a href="wheel-library.html" style="color: var(--text-secondary); text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='var(--accent-primary)'" onmouseout="this.style.color='var(--text-secondary)'">Wheel Library</a></li>
                    </ul>
                </div>
            </div>
            
            <!-- Copyright -->
            <div style="text-align: center; padding-top: 30px; border-top: 1px solid var(--border-color); color: var(--text-muted); font-size: 0.9rem;">
                <p>© 2024 WheelTester. Professional Racing Wheel Diagnostic Tool.</p>
                <p style="margin-top: 10px;">Made for sim racing enthusiasts worldwide 🏁</p>
            </div>
        </div>
    </footer>

    <script>
        // ========================================
        // IMAGE PATHS - Change all images here
        // ========================================
        const imagePaths = {
            // Steering Wheel
            steeringWheel: 'https://i.ibb.co/cK0FCL2/wheel.png',
            
            // Pedals
            accelerator: 'https://i.ibb.co/gFJn0vjh/pd-acce.png',
            brake: 'https://i.ibb.co/Cs13H3bw/pd-break.png',
            clutch: 'https://i.ibb.co/WQvqmD7/pd-clutch.png',
            
            // Face Buttons
            triangle: 'https://i.ibb.co/spqW0R9g/triangle.png',
            circle: 'https://i.ibb.co/Kzwx2vVZ/circle.png',
            x: 'https://i.ibb.co/cKky9BVx/x.png',
            square: 'https://i.ibb.co/ycPF220P/square.png',
            
            // D-Pad
            up: 'https://i.ibb.co/WWrtx9Pp/up.png',
            down: 'https://i.ibb.co/HDHYBM0k/down.png',
            left: 'https://i.ibb.co/KcVxctxy/left.png',
            right: 'https://i.ibb.co/Xcr3V7p/right.png',
            
            // Center Buttons
            select: 'https://i.ibb.co/cPCvLNG/select.png',
            start: 'https://i.ibb.co/2YS6TgzH/start.png',
            
            // Shifter
            shifter: 'https://i.ibb.co/j9Rmspwz/SHIFTER.png',
            shifterIndicator: 'https://i.ibb.co/5hKvqVM4/BOITA.png'
        };

        // Gamepad State
        let gamepadIndex = null;
        let animationId = null;
        let maxRotationDegrees = 900; // Default for G29/G920/G923
        let calibration = {
            steeringCenter: 0,
            acceleratorMin: 1,
            acceleratorMax: -1,
            brakeMin: 1,
            brakeMax: -1,
            clutchMin: 1,
            clutchMax: -1
        };

        // Rating System
        let rating = {
            steeringLeft: false,
            steeringRight: false,
            accelerator: false,
            brake: false,
            clutch: false,
            buttons: new Set(),
            gears: new Set(),
            dpad: new Set(), // Track D-pad directions
            totalButtons: 18, // Visible buttons (0-11, 19-24) = 18 buttons
            visibleButtons: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 19, 20, 21, 22, 23, 24] // Buttons to track
        };

        // DOM Elements
        const elements = {
            connectionStatus: document.getElementById('connection-status'),
            gamepadName: document.getElementById('gamepad-name'),
            warning: document.getElementById('warning'),
            mainContent: document.getElementById('main-content'),
            wheelName: document.getElementById('wheel-name'),
            steeringWheel: document.getElementById('steering-wheel'),
            steeringPercent: document.getElementById('steering-percent'),
            steeringDirection: document.getElementById('steering-direction'),
            pedalImageAccelerator: document.getElementById('pedal-image-accelerator'),
            pedalImageBrake: document.getElementById('pedal-image-brake'),
            pedalImageClutch: document.getElementById('pedal-image-clutch'),
            valueAccelerator: document.getElementById('value-accelerator'),
            valueBrake: document.getElementById('value-brake'),
            valueClutch: document.getElementById('value-clutch'),
            currentGear: document.getElementById('current-gear')
        };

        // Utility Functions
        function clamp(value, min, max) {
            return Math.min(Math.max(value, min), max);
        }

        // Hide buttons that don't exist on G920
        function hideG920Buttons() {
            // G920 doesn't have: SELECT (8), START (9), PS (24), +/- (19,20), scroll arrows (21,22), ENTER (23)
            const buttonsToHide = [8, 9, 19, 20, 21, 22, 23, 24];
            
            buttonsToHide.forEach(buttonIndex => {
                const button = document.querySelector(`[data-button="${buttonIndex}"]`);
                if (button) {
                    button.style.display = 'none';
                }
            });
            
            // Update rating to exclude hidden buttons
            rating.totalButtons = 14; // Only 14 buttons on G920 (0-7, 10-11 + 4 D-pad)
            rating.visibleButtons = [0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15]; // Face + shoulder + L3/R3 + D-pad
        }

        function clamp(value, min, max) {
            return Math.min(Math.max(value, min), max);
        }

        function normalize(value, min, max) {
            if (max === min) return 0;
            return clamp((value - min) / (max - min), 0, 1);
        }

        function mapRange(value, inMin, inMax, outMin, outMax) {
            return (value - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;
        }

        // Gamepad Connection Handlers
        function onGamepadConnected(event) {
            const gamepad = event.gamepad;
            
            // Check if it's a racing wheel (not a regular controller)
            const gamepadId = gamepad.id.toLowerCase();
            const isWheel = gamepadId.includes('g29') || 
                           gamepadId.includes('g920') || 
                           gamepadId.includes('g923') || 
                           gamepadId.includes('g27') || 
                           gamepadId.includes('g25') ||
                           gamepadId.includes('logitech') ||
                           gamepadId.includes('thrustmaster') ||
                           gamepadId.includes('fanatec') ||
                           gamepadId.includes('wheel') ||
                           gamepadId.includes('racing');
            
            // If not a wheel, ignore this device and keep looking for a wheel
            if (!isWheel) {
                console.log('Non-wheel device detected, ignoring:', gamepad.id);
                
                // Show the non-wheel device name but don't allow testing
                elements.connectionStatus.textContent = 'Invalid Device';
                elements.connectionStatus.classList.remove('connected');
                elements.gamepadName.textContent = gamepad.id; // Show the controller name
                elements.warning.classList.remove('hidden');
                elements.mainContent.classList.remove('visible');
                
                const warningText = document.querySelector('.warning-text');
                if (warningText) {
                    warningText.textContent = '⚠️ This device is not a racing wheel. Please connect a compatible racing wheel (Logitech, Thrustmaster, Fanatec, etc.).';
                }
                
                return; // Don't set gamepadIndex for non-wheel devices
            }
            
            // It's a wheel, connect to it
            gamepadIndex = gamepad.index;
            console.log('Racing wheel detected:', gamepad.id); 
            
            // Extract wheel name from gamepad ID
            let wheelName = gamepad.id;
            if (wheelName.includes('G29')) {
                wheelName = 'Logitech G29';
            } else if (wheelName.includes('G920')) {
                wheelName = 'Logitech G920';
                // Hide buttons that don't exist on G920 (Xbox version)
                hideG920Buttons();
            } else if (wheelName.includes('G923')) {
                wheelName = 'Logitech G923';
            } else if (wheelName.includes('G27')) {
                wheelName = 'Logitech G27';
            } else if (wheelName.includes('G25')) {
                wheelName = 'Logitech G25';
            } else if (wheelName.toLowerCase().includes('logitech')) {
                wheelName = 'Logitech Wheel';
            } else {
                wheelName = gamepad.id.substring(0, 30); // Truncate if too long
            }
            
            // Update UI
            elements.connectionStatus.textContent = 'Connected';
            elements.connectionStatus.classList.add('connected');
            elements.gamepadName.textContent = gamepad.id;
            elements.wheelName.textContent = wheelName;
            elements.warning.classList.add('hidden');
            elements.mainContent.classList.add('visible');

            // Initialize buttons grid
            initializeButtons(gamepad.buttons.length);

            // Start polling
            if (!animationId) {
                pollGamepad();
            }

            console.log('Gamepad connected:', gamepad);
        }

        function onGamepadDisconnected(event) {
            if (event.gamepad.index === gamepadIndex) {
                gamepadIndex = null;
                
                // Update UI
                elements.connectionStatus.textContent = 'Disconnected';
                elements.connectionStatus.classList.remove('connected');
                elements.gamepadName.textContent = 'None';
                elements.warning.classList.remove('hidden');
                elements.mainContent.classList.remove('visible');

                // Stop polling
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }

                console.log('Gamepad disconnected');
            }
        }

        // Initialize Buttons - No longer needed as buttons are pre-defined in HTML
        function initializeButtons(count) {
            // Buttons are now statically defined in HTML with data-button attributes
            console.log(`Gamepad has ${count} buttons`);
        }

        // Update Steering Display
        function updateSteering(value) {
            // Apply calibration
            const centered = value - calibration.steeringCenter;
            const normalized = clamp(centered, -1, 1);
            const percentage = Math.round(normalized * 100);
            const rotation = normalized * 450; // Max 450 degrees each way (900 total)
            const degrees = Math.round(Math.abs(normalized * 450)); // Current degrees from center

            // Update UI
            elements.steeringWheel.style.transform = `rotate(${rotation}deg)`;
            elements.steeringPercent.textContent = degrees; // Show degrees instead of percentage

            // Update direction
            if (percentage < -5) {
                elements.steeringDirection.textContent = 'LEFT';
            } else if (percentage > 5) {
                elements.steeringDirection.textContent = 'RIGHT';
            } else {
                elements.steeringDirection.textContent = 'CENTER';
            }

            // Rating: Check if steering reached 100% left and right
            if (percentage <= -95) rating.steeringLeft = true;
            if (percentage >= 95) rating.steeringRight = true;
            updateRating();
        }

        // Update Pedal Display - Using images
        function updatePedal(imageElement, valueElement, rawValue, min, max, pedalName) {
            const normalized = normalize(rawValue, min, max);
            const percentage = Math.round(normalized * 100);
            
            // Update image brightness and position based on pressure
            if (percentage > 5) {
                imageElement.classList.add('pressed');
                imageElement.style.filter = `brightness(${0.5 + (percentage / 100) * 0.5}) drop-shadow(0 0 ${percentage / 5}px currentColor)`;
                imageElement.style.transform = `translateY(${percentage / 20}px)`;
            } else {
                imageElement.classList.remove('pressed');
                imageElement.style.filter = 'brightness(0.5)';
                imageElement.style.transform = 'translateY(0)';
            }
            
            valueElement.textContent = `${percentage}%`;

            // Rating: Check if pedal reached 95%
            if (percentage >= 95) {
                rating[pedalName] = true;
                updateRating();
            }
        }

        // Update Buttons Display
        function updateButtons(buttons, axes) {
            // Find all button elements with data-button attribute
            const buttonElements = document.querySelectorAll('[data-button]');
            
            buttonElements.forEach(element => {
                const buttonIndex = parseInt(element.getAttribute('data-button'));
                if (buttonIndex < buttons.length) {
                    const button = buttons[buttonIndex];
                    const isPressed = button.pressed || button.value > 0.5;
                    element.classList.toggle('pressed', isPressed);
                    
                    // Rating: Track pressed buttons (only visible ones, excluding shifter buttons 12-18)
                    if (isPressed && rating.visibleButtons.includes(buttonIndex)) {
                        rating.buttons.add(buttonIndex);
                        updateRating();
                    }
                }
            });

            // Handle D-Pad via axis 9 on G29
            if (axes.length > 9) {
                const dpadValue = axes[9];
                
                const isPressed = Math.abs(dpadValue) <= 1.0;
                
                if (isPressed) {
                    // Up: -1.0 to -0.6
                    const upPressed = dpadValue <= -0.6;
                    document.querySelector('.dpad-up')?.classList.toggle('pressed', upPressed);
                    if (upPressed) rating.dpad.add('up');
                    
                    // Right: -0.6 to -0.2
                    const rightPressed = dpadValue > -0.6 && dpadValue <= -0.2;
                    document.querySelector('.dpad-right')?.classList.toggle('pressed', rightPressed);
                    if (rightPressed) rating.dpad.add('right');
                    
                    // Down: -0.2 to 0.3
                    const downPressed = dpadValue > -0.2 && dpadValue <= 0.3;
                    document.querySelector('.dpad-down')?.classList.toggle('pressed', downPressed);
                    if (downPressed) rating.dpad.add('down');
                    
                    // Left: 0.3 to 1.0
                    const leftPressed = dpadValue > 0.3 && dpadValue <= 1.0;
                    document.querySelector('.dpad-left')?.classList.toggle('pressed', leftPressed);
                    if (leftPressed) rating.dpad.add('left');
                    
                    updateRating();
                } else {
                    // Not pressed - clear all
                    document.querySelector('.dpad-up')?.classList.remove('pressed');
                    document.querySelector('.dpad-right')?.classList.remove('pressed');
                    document.querySelector('.dpad-down')?.classList.remove('pressed');
                    document.querySelector('.dpad-left')?.classList.remove('pressed');
                }
            }
        }

        // Update Shifter Display
        function updateShifter(buttons) {
            // G29 Shifter uses buttons for gears
            // Exact mapping based on user testing
            
            let gear = 'N';
            const indicator = document.getElementById('shifter-indicator');
            
            // Button to gear mapping
            const buttonToGear = {
                12: '1',
                13: '2', 
                14: '3',
                15: '4',
                16: '5',
                17: '6',
                18: 'R'
            };
            
            // Gear positions on the shifter image (percentages from center)
            const gearPositions = {
                '1': { left: '30%', top: '32%' },
                '2': { left: '30%', top: '74%' },
                '3': { left: '50.2%', top: '32%' },
                '4': { left: '50.2%', top: '74%' },
                '5': { left: '70.35%', top: '32%' },
                '6': { left: '70.35%', top: '74%' },
                'R': { left: '70.35%', top: '74%' }
            };
            
            // Check which button is pressed
            let gearFound = false;
            for (let i = 0; i < buttons.length; i++) {
                if (buttons[i].pressed && buttonToGear[i]) {
                    gear = buttonToGear[i];
                    gearFound = true;
                    
                    // Position the indicator
                    const pos = gearPositions[gear];
                    indicator.style.left = pos.left;
                    indicator.style.top = pos.top;
                    indicator.style.transform = 'translate(-50%, -50%)';
                    indicator.classList.add('active');
                    
                    // Rating: Track tested gears
                    rating.gears.add(gear);
                    updateRating();
                    break;
                }
            }
            
            // Hide indicator if no gear selected
            if (!gearFound) {
                indicator.classList.remove('active');
            }
            
            elements.currentGear.textContent = gear;
        }

        // Update Rating Display
        function updateRating() {
            const ratingElements = {
                steering: document.getElementById('rating-steering'),
                accelerator: document.getElementById('rating-accelerator'),
                brake: document.getElementById('rating-brake'),
                clutch: document.getElementById('rating-clutch'),
                buttons: document.getElementById('rating-buttons'),
                gears: document.getElementById('rating-gears'),
                percentage: document.getElementById('rating-percentage'),
                steeringPercent: document.getElementById('rating-steering-percent'),
                acceleratorPercent: document.getElementById('rating-accelerator-percent'),
                brakePercent: document.getElementById('rating-brake-percent'),
                clutchPercent: document.getElementById('rating-clutch-percent'),
                buttonsPercent: document.getElementById('rating-buttons-percent'),
                gearsPercent: document.getElementById('rating-gears-percent')
            };

            // Steering (10%)
            let steeringCount = (rating.steeringLeft ? 1 : 0) + (rating.steeringRight ? 1 : 0);
            let steeringPercent = (steeringCount / 2) * 10;
            ratingElements.steering.textContent = `${steeringCount}/2`;
            ratingElements.steering.className = steeringCount === 2 ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.steeringPercent.textContent = `${steeringPercent.toFixed(0)}%`;

            // Accelerator (10%)
            let acceleratorPercent = rating.accelerator ? 10 : 0;
            ratingElements.accelerator.textContent = rating.accelerator ? '✓' : '✗';
            ratingElements.accelerator.className = rating.accelerator ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.acceleratorPercent.textContent = `${acceleratorPercent}%`;

            // Brake (10%)
            let brakePercent = rating.brake ? 10 : 0;
            ratingElements.brake.textContent = rating.brake ? '✓' : '✗';
            ratingElements.brake.className = rating.brake ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.brakePercent.textContent = `${brakePercent}%`;

            // Clutch (10%)
            let clutchPercent = rating.clutch ? 10 : 0;
            ratingElements.clutch.textContent = rating.clutch ? '✓' : '✗';
            ratingElements.clutch.className = rating.clutch ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.clutchPercent.textContent = `${clutchPercent}%`;

            // Buttons + D-Pad (40%) - 18 buttons + 4 dpad = 22 total
            let totalButtonsAndDpad = rating.buttons.size + rating.dpad.size;
            let buttonsPercent = (totalButtonsAndDpad / 22) * 40;
            ratingElements.buttons.textContent = `${totalButtonsAndDpad}/22`;
            ratingElements.buttons.className = totalButtonsAndDpad === 22 ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.buttonsPercent.textContent = `${buttonsPercent.toFixed(0)}%`;

            // Gears (20%)
            let gearsPercent = (rating.gears.size / 7) * 20;
            ratingElements.gears.textContent = `${rating.gears.size}/7`;
            ratingElements.gears.className = rating.gears.size === 7 ? 'rating-status completed' : 'rating-status incomplete';
            ratingElements.gearsPercent.textContent = `${gearsPercent.toFixed(0)}%`;

            // Calculate total percentage (100%)
            const totalPercentage = steeringPercent + acceleratorPercent + brakePercent + clutchPercent + buttonsPercent + gearsPercent;
            ratingElements.percentage.textContent = `${totalPercentage.toFixed(0)}%`;

            // Update grade text
            const gradeElement = document.getElementById('rating-grade');
            if (totalPercentage >= 90) {
                gradeElement.textContent = 'Excellent';
                gradeElement.className = 'rating-grade excellent';
            } else if (totalPercentage >= 70) {
                gradeElement.textContent = 'Good';
                gradeElement.className = 'rating-grade good';
            } else if (totalPercentage >= 50) {
                gradeElement.textContent = 'Average';
                gradeElement.className = 'rating-grade average';
            } else {
                gradeElement.textContent = 'Poor';
                gradeElement.className = 'rating-grade poor';
            }
        }

        // Main Polling Loop
        function pollGamepad() {
            const gamepads = navigator.getGamepads();
            const gamepad = gamepads[gamepadIndex];

            if (gamepad) {
                // Update Steering (axis 0)
                if (gamepad.axes.length > 0) {
                    updateSteering(gamepad.axes[0]);
                }

                // Update Pedals - CORRECTED MAPPING
                // G29: Clutch = axis 1, Accelerator = axis 2, Brake = axis 5
                if (gamepad.axes.length > 1) {
                    updatePedal(
                        elements.pedalImageClutch,
                        elements.valueClutch,
                        gamepad.axes[1],
                        calibration.clutchMin,
                        calibration.clutchMax,
                        'clutch'
                    );
                }

                if (gamepad.axes.length > 2) {
                    updatePedal(
                        elements.pedalImageAccelerator,
                        elements.valueAccelerator,
                        gamepad.axes[2],
                        calibration.acceleratorMin,
                        calibration.acceleratorMax,
                        'accelerator'
                    );
                }

                if (gamepad.axes.length > 5) {
                    updatePedal(
                        elements.pedalImageBrake,
                        elements.valueBrake,
                        gamepad.axes[5],
                        calibration.brakeMin,
                        calibration.brakeMax,
                        'brake'
                    );
                }

                // Update Buttons
                updateButtons(gamepad.buttons, gamepad.axes);

                // Update Shifter
                updateShifter(gamepad.buttons);
            }

            animationId = requestAnimationFrame(pollGamepad);
        }

        // Calibration
        function calibrate() {
            const gamepads = navigator.getGamepads();
            const gamepad = gamepads[gamepadIndex];

            if (!gamepad) {
                alert('No gamepad connected!');
                return;
            }

            // Set current steering position as center
            if (gamepad.axes.length > 0) {
                calibration.steeringCenter = gamepad.axes[0];
            }

            // Set current pedal positions as min (resting position = 0%)
            // Inverted calibration: unpressed = max value (1), pressed = min value (-1)
            if (gamepad.axes.length > 1) {
                calibration.clutchMin = gamepad.axes[1];
                calibration.clutchMax = calibration.clutchMin > 0 ? -1 : 1;
            }

            if (gamepad.axes.length > 2) {
                calibration.acceleratorMin = gamepad.axes[2];
                calibration.acceleratorMax = calibration.acceleratorMin > 0 ? -1 : 1;
            }

            if (gamepad.axes.length > 5) {
                calibration.brakeMin = gamepad.axes[5];
                calibration.brakeMax = calibration.brakeMin > 0 ? -1 : 1;
            }

            alert('Calibration complete!\n\n' +
                  'Steering center set: ' + calibration.steeringCenter.toFixed(3) + '\n' +
                  'Pedals at 0%. Press pedals fully to reach 100%.');

            console.log('Calibration:', calibration);
        }

        // Force Feedback Test
        function testForceFeedback() {
            const gamepads = navigator.getGamepads();
            const gamepad = gamepads[gamepadIndex];

            if (!gamepad) {
                alert('No gamepad connected!');
                return;
            }

            if (!gamepad.vibrationActuator) {
                alert('Force feedback not supported on this device or browser.\n\nNote: Force feedback requires:\n- Chrome/Edge browser\n- Proper wheel drivers installed');
                console.log('Gamepad object:', gamepad);
                return;
            }

            // Test with a strong rumble effect
            gamepad.vibrationActuator.playEffect('dual-rumble', {
                startDelay: 0,
                duration: 1000,
                weakMagnitude: 0.5,
                strongMagnitude: 1.0
            }).then(() => {
                console.log('Force feedback test completed');
            }).catch(err => {
                console.error('Force feedback error:', err);
                alert('Force feedback test failed. Check console for details.');
            });

            console.log('Testing force feedback...');
        }

        // Event Listeners
        window.addEventListener('gamepadconnected', onGamepadConnected);
        window.addEventListener('gamepaddisconnected', onGamepadDisconnected);

        // Disable right-click
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });

        // Disable keyboard shortcuts for inspect
        document.addEventListener('keydown', (e) => {
            // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+Shift+C
            if (
                e.key === 'F12' ||
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                (e.ctrlKey && e.key === 'u') ||
                (e.ctrlKey && e.key === 'U')
            ) {
                e.preventDefault();
                return false;
            }
        });

        // Rating System Toggle
        const startRatingBtn = document.getElementById('start-rating-btn');
        const ratingContainer = document.getElementById('rating-container');
        const ratingClose = document.getElementById('rating-close');

        startRatingBtn.addEventListener('click', () => {
            startRatingBtn.classList.add('hidden');
            ratingContainer.classList.remove('hidden');
            
            // Reset rating
            rating.steeringLeft = false;
            rating.steeringRight = false;
            rating.accelerator = false;
            rating.brake = false;
            rating.clutch = false;
            rating.buttons.clear();
            rating.gears.clear();
            rating.dpad.clear();
            updateRating();
        });

        ratingClose.addEventListener('click', () => {
            ratingContainer.classList.add('hidden');
            startRatingBtn.classList.remove('hidden');
        });

        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const themeText = document.getElementById('theme-text');
        
        // Check for saved theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-mode');
            themeIcon.textContent = '🌙';
            themeText.textContent = 'Dark Mode';
        }
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            
            if (isLight) {
                themeIcon.textContent = '🌙';
                themeText.textContent = 'Dark Mode';
                localStorage.setItem('theme', 'light');
            } else {
                themeIcon.textContent = '☀️';
                themeText.textContent = 'Light Mode';
                localStorage.setItem('theme', 'dark');
            }
        });

        // Check for already connected gamepads on load
        window.addEventListener('load', () => {
            // Load images from imagePaths
            loadImages();
            
            // Look for a racing wheel among all connected devices
            const gamepads = navigator.getGamepads();
            let wheelFound = false;
            
            for (let i = 0; i < gamepads.length; i++) {
                if (gamepads[i]) {
                    const gamepadId = gamepads[i].id.toLowerCase();
                    const isWheel = gamepadId.includes('g29') || 
                                   gamepadId.includes('g920') || 
                                   gamepadId.includes('g923') || 
                                   gamepadId.includes('g27') || 
                                   gamepadId.includes('g25') ||
                                   gamepadId.includes('logitech') ||
                                   gamepadId.includes('thrustmaster') ||
                                   gamepadId.includes('fanatec') ||
                                   gamepadId.includes('wheel') ||
                                   gamepadId.includes('racing');
                    
                    if (isWheel) {
                        onGamepadConnected({ gamepad: gamepads[i] });
                        wheelFound = true;
                        break; // Stop after finding the first wheel
                    }
                }
            }
            
            // If no wheel found, try connecting to any device (will show error if not a wheel)
            if (!wheelFound) {
                for (let i = 0; i < gamepads.length; i++) {
                    if (gamepads[i]) {
                        onGamepadConnected({ gamepad: gamepads[i] });
                        break;
                    }
                }
            }
        });

        // Load images from imagePaths object
        function loadImages() {
            // Pedals
            document.getElementById('pedal-image-clutch').src = imagePaths.clutch;
            document.getElementById('pedal-image-brake').src = imagePaths.brake;
            document.getElementById('pedal-image-accelerator').src = imagePaths.accelerator;
            
            // Face buttons
            document.querySelector('[data-button="3"] img').src = imagePaths.triangle;
            document.querySelector('[data-button="2"] img').src = imagePaths.circle;
            document.querySelector('[data-button="0"] img').src = imagePaths.x;
            document.querySelector('[data-button="1"] img').src = imagePaths.square;
            
            // D-Pad
            document.querySelector('[data-button="12"] img').src = imagePaths.up;
            document.querySelector('[data-button="13"] img').src = imagePaths.down;
            document.querySelector('[data-button="14"] img').src = imagePaths.left;
            document.querySelector('[data-button="15"] img').src = imagePaths.right;
            
            // Center buttons
            document.querySelector('[data-button="8"] img').src = imagePaths.select;
            document.querySelector('[data-button="9"] img').src = imagePaths.start;
            
            // Shifter
            document.querySelector('.shifter-image').src = imagePaths.shifter;
            
            // Shifter indicator (background image)
            document.getElementById('shifter-indicator').style.backgroundImage = `url('${imagePaths.shifterIndicator}')`;
        }

        // Report Problem Modal
        const reportBtn = document.getElementById('report-btn');
        const reportModal = document.getElementById('report-modal');
        const reportClose = document.getElementById('report-close');
        const reportForm = document.getElementById('report-form');
        const reportWheelSelect = document.getElementById('report-wheel');
        const otherWheelContainer = document.getElementById('other-wheel-container');
        const otherWheelInput = document.getElementById('other-wheel-input');
        const reportProblemSelect = document.getElementById('report-problem');
        const otherProblemContainer = document.getElementById('other-problem-container');
        const otherProblemInput = document.getElementById('other-problem-input');

        // Show/hide Other wheel input
        reportWheelSelect.addEventListener('change', () => {
            if (reportWheelSelect.value === 'Other') {
                otherWheelContainer.style.display = 'block';
                otherWheelInput.required = true;
            } else {
                otherWheelContainer.style.display = 'none';
                otherWheelInput.required = false;
                otherWheelInput.value = '';
            }
        });

        // Show/hide Other problem input
        reportProblemSelect.addEventListener('change', () => {
            if (reportProblemSelect.value === 'Other') {
                otherProblemContainer.style.display = 'block';
                otherProblemInput.required = true;
            } else {
                otherProblemContainer.style.display = 'none';
                otherProblemInput.required = false;
                otherProblemInput.value = '';
            }
        });

        reportBtn.addEventListener('click', () => {
            reportModal.classList.add('active');
        });

        reportClose.addEventListener('click', () => {
            reportModal.classList.remove('active');
        });

        reportModal.addEventListener('click', (e) => {
            if (e.target === reportModal) {
                reportModal.classList.remove('active');
            }
        });

        // Success Page Function
        function showSuccessPage(email, wheel, problem) {
            const successPage = document.createElement('div');
            successPage.id = 'success-page';
            successPage.innerHTML = `
                <div class="success-content">
                    <div class="success-icon">✓</div>
                    <h2 class="success-title">Thank you for your report!</h2>
                    <p class="success-message">We have received your feedback and will look into it.</p>
                    <p class="success-email">A confirmation email has been sent to: <strong>${email}</strong></p>
                    <div class="success-details">
                        <p><strong>Wheel:</strong> ${wheel}</p>
                        <p><strong>Problem:</strong> ${problem}</p>
                    </div>
                    <button class="success-btn" onclick="document.getElementById('success-page').remove()">OK</button>
                </div>
            `;
            document.body.appendChild(successPage);
        }

        reportForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Get form values
            let wheel = document.getElementById('report-wheel').value;
            let problem = document.getElementById('report-problem').value;
            const email = document.getElementById('report-email').value;
            const description = document.getElementById('report-description').value;
            
            // If Other is selected for wheel, use the custom input
            if (wheel === 'Other') {
                wheel = otherWheelInput.value;
            }
            
            // If Other is selected for problem, use the custom input
            if (problem === 'Other') {
                problem = otherProblemInput.value;
            }
            
            // Show loading spinner
            const submitBtn = document.getElementById('report-submit-btn');
            const submitText = submitBtn.querySelector('.submit-text');
            const submitLoader = submitBtn.querySelector('.submit-loader');
            submitBtn.disabled = true;
            submitText.style.display = 'none';
            submitLoader.style.display = 'flex';
            
            // Send report to admin via EmailJS
            emailjs.send('service_2ebwisc', 'template_xul7dbl', {
                to_email: 'contact@wheeltester.com',
                from_email: email,
                user_email: email,
                wheel: wheel,
                problem: problem,
                description: description || 'No additional details provided'
            })
            .then(() => {
                // Send confirmation email to user
                return emailjs.send('service_2ebwisc', 'template_cu9otuo', {
                    to_email: email,
                    user_email: email,
                    wheel: wheel,
                    problem: problem,
                    description: description || 'No additional details provided'
                });
            })
            .then(() => {
                // Show success page instead of alert
                showSuccessPage(email, wheel, problem);
                reportModal.classList.remove('active');
                reportForm.reset();
                otherWheelContainer.style.display = 'none';
                otherProblemContainer.style.display = 'none';
                
                // Reset button
                submitBtn.disabled = false;
                submitText.style.display = 'inline';
                submitLoader.style.display = 'none';
            })
            .catch((error) => {
                console.error('EmailJS Error:', error);
                alert('Error sending report. Please check your internet connection and try again.');
                
                // Reset button
                submitBtn.disabled = false;
                submitText.style.display = 'inline';
                submitLoader.style.display = 'none';
            });
        });

        console.log('Racing Wheel Tester initialized');
    </script>
</body>
</html>
